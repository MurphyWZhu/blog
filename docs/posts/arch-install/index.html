<!DOCTYPE html>
<html lang="zh-cn" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Arch Install | 锦酱的博客</title>
<meta name="keywords" content="" />
<meta name="description" content="安装前准备 制作启动盘 下载最新版本的archlinux安装镜像文件
Linux： dd bs=4M if=镜像路径 of=/dev/USB设备标识符 conv=fsync oflag=direct status=progress Windows： 使用Rufus制作
MacOS： diskutil unmountDisk /dev/USB设备标识符 #MacOS也许会自动挂载USB设备，先卸载 dd if=镜像路径 of=/dev/USB设备标识符 bs=1m 引导系统 将制作好的USB启动盘插在要安装archlinux的电脑上
开机的时候按某个按键(不同品牌及机器不一样)，进入选择引导介质的界面，选择USB设备
即可引导进入archlinux live
 安装前配置 setfont /usr/share/kbd/consolefonts/iso01-12x22.psfu.gz #将字体设置大一点 timedatectl set-ntp true #设置网络时间 磁盘设置  数据无价，请确认后再操作
 分区 archlinux一般需要分一下几个区
   分区名称 挂载点 分区类型 建议大小     EFI引导分区 /mnt/boot EFI system partition 512M   根分区 /mnt Linux 磁盘剩下的空间   数据分区[可选] /data Linux    家分区[可选] /home Linux     分区要具体看用途，及你的电脑的磁盘配置">
<meta name="author" content="">
<link rel="canonical" href="https://murphywzhu.github.io/blog/posts/arch-install/" />
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.min.04512c372388e08b5118f5b117b2d3efef4ddae52017e16085c8d8d4e361c43d.css" integrity="sha256-BFEsNyOI4ItRGPWxF7LT7&#43;9N2uUgF&#43;FghcjY1ONhxD0=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/blog/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://murphywzhu.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://murphywzhu.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://murphywzhu.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://murphywzhu.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://murphywzhu.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.84.0" />
<meta property="og:title" content="Arch Install" />
<meta property="og:description" content="安装前准备 制作启动盘 下载最新版本的archlinux安装镜像文件
Linux： dd bs=4M if=镜像路径 of=/dev/USB设备标识符 conv=fsync oflag=direct status=progress Windows： 使用Rufus制作
MacOS： diskutil unmountDisk /dev/USB设备标识符 #MacOS也许会自动挂载USB设备，先卸载 dd if=镜像路径 of=/dev/USB设备标识符 bs=1m 引导系统 将制作好的USB启动盘插在要安装archlinux的电脑上
开机的时候按某个按键(不同品牌及机器不一样)，进入选择引导介质的界面，选择USB设备
即可引导进入archlinux live
 安装前配置 setfont /usr/share/kbd/consolefonts/iso01-12x22.psfu.gz #将字体设置大一点 timedatectl set-ntp true #设置网络时间 磁盘设置  数据无价，请确认后再操作
 分区 archlinux一般需要分一下几个区
   分区名称 挂载点 分区类型 建议大小     EFI引导分区 /mnt/boot EFI system partition 512M   根分区 /mnt Linux 磁盘剩下的空间   数据分区[可选] /data Linux    家分区[可选] /home Linux     分区要具体看用途，及你的电脑的磁盘配置" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://murphywzhu.github.io/blog/posts/arch-install/" />
<meta property="og:image" content="https://mublog.oss-cn-beijing.aliyuncs.com/824c2c178b82434c2abbe9e485de1daa.jpeg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-21T12:49:02&#43;08:00" />
<meta property="article:modified_time" content="2021-04-21T12:49:02&#43;08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://mublog.oss-cn-beijing.aliyuncs.com/824c2c178b82434c2abbe9e485de1daa.jpeg" />
<meta name="twitter:title" content="Arch Install"/>
<meta name="twitter:description" content="安装前准备 制作启动盘 下载最新版本的archlinux安装镜像文件
Linux： dd bs=4M if=镜像路径 of=/dev/USB设备标识符 conv=fsync oflag=direct status=progress Windows： 使用Rufus制作
MacOS： diskutil unmountDisk /dev/USB设备标识符 #MacOS也许会自动挂载USB设备，先卸载 dd if=镜像路径 of=/dev/USB设备标识符 bs=1m 引导系统 将制作好的USB启动盘插在要安装archlinux的电脑上
开机的时候按某个按键(不同品牌及机器不一样)，进入选择引导介质的界面，选择USB设备
即可引导进入archlinux live
 安装前配置 setfont /usr/share/kbd/consolefonts/iso01-12x22.psfu.gz #将字体设置大一点 timedatectl set-ntp true #设置网络时间 磁盘设置  数据无价，请确认后再操作
 分区 archlinux一般需要分一下几个区
   分区名称 挂载点 分区类型 建议大小     EFI引导分区 /mnt/boot EFI system partition 512M   根分区 /mnt Linux 磁盘剩下的空间   数据分区[可选] /data Linux    家分区[可选] /home Linux     分区要具体看用途，及你的电脑的磁盘配置"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://murphywzhu.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Arch Install",
      "item": "https://murphywzhu.github.io/blog/posts/arch-install/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Arch Install",
  "name": "Arch Install",
  "description": "安装前准备 制作启动盘 下载最新版本的archlinux安装镜像文件\nLinux： dd bs=4M if=镜像路径 of=/dev/USB设备标识符 conv=fsync oflag=direct status=progress Windows： 使用Rufus制作\nMacOS： diskutil unmountDisk /dev/USB设备标识符 #MacOS也许会自动挂载USB设备，先卸载 dd if=镜像路径 of=/dev/USB设备标识符 bs=1m 引导系统 将制作好的USB启动盘插在要安装archlinux的电脑上\n开机的时候按某个按键(不同品牌及机器不一样)，进入选择引导介质的界面，选择USB设备\n即可引导进入archlinux live\n 安装前配置 setfont /usr/share/kbd/consolefonts/iso01-12x22.psfu.gz #将字体设置大一点 timedatectl set-ntp true #设置网络时间 磁盘设置  数据无价，请确认后再操作\n 分区 archlinux一般需要分一下几个区\n   分区名称 挂载点 分区类型 建议大小     EFI引导分区 /mnt/boot EFI system partition 512M   根分区 /mnt Linux 磁盘剩下的空间   数据分区[可选] /data Linux    家分区[可选] /home Linux     分区要具体看用途，及你的电脑的磁盘配置",
  "keywords": [
    
  ],
  "articleBody": "安装前准备 制作启动盘 下载最新版本的archlinux安装镜像文件\nLinux： dd bs=4M if=镜像路径 of=/dev/USB设备标识符 conv=fsync oflag=direct status=progress Windows： 使用Rufus制作\nMacOS： diskutil unmountDisk /dev/USB设备标识符 #MacOS也许会自动挂载USB设备，先卸载 dd if=镜像路径 of=/dev/USB设备标识符 bs=1m 引导系统 将制作好的USB启动盘插在要安装archlinux的电脑上\n开机的时候按某个按键(不同品牌及机器不一样)，进入选择引导介质的界面，选择USB设备\n即可引导进入archlinux live\n 安装前配置 setfont /usr/share/kbd/consolefonts/iso01-12x22.psfu.gz #将字体设置大一点 timedatectl set-ntp true #设置网络时间 磁盘设置  数据无价，请确认后再操作\n 分区 archlinux一般需要分一下几个区\n   分区名称 挂载点 分区类型 建议大小     EFI引导分区 /mnt/boot EFI system partition 512M   根分区 /mnt Linux 磁盘剩下的空间   数据分区[可选] /data Linux    家分区[可选] /home Linux     分区要具体看用途，及你的电脑的磁盘配置\n如果只有一块硬盘，可以只分EFI分区及根分区\n如果有一块固态和一块机械，可以把固态分为EFI分区及根分区，机械分为数据分区或家分区\n我的电脑是一块NVME固态和一块SATA固态，我将NVME分为EFI分区及根分区，将SATA分为家分区\n计划好分区后使用fdisk命令来分区\n使用fdisk /dev/磁盘标识符进入交互式工具\n可以使用lsblk查看到磁盘标识符\n如我的电脑有一块名为sda的sata固体硬盘和一块名为nvme0n1的nvme固体硬盘\nNAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS sda 8:0 0 465.8G 0 disk └─sda1 8:1 0 465.8G 0 part /home nvme0n1 259:0 0 238.5G 0 disk ├─nvme0n1p1 259:1 0 512M 0 part /boot └─nvme0n1p2 259:2 0 238G 0 part / 我们主要使用fdisk的以下功能\n查看分区，在fdisk输入p即可查看已有分区的信息\n新建分区表，在fdisk输入g即可创建一个新的gpt分区表\n新建分区，在fdisk输入n并根据提示输入大小等信息即可创建一个分区\n更改分区类型，fdisk默认的分区格式是linux，创建EFI需要将分区格式改为EFI格式，在fdisk输入t，再根据提示输入EFI的代码1，即可更改为EFI类型，只需要更改EFI分区的格式就行了\n保存更改，fdisk交互式命令的操作不会马上生效，需要保存才能生效，输入w即可保存**(数据无价请确认后再操作)**\n格式化分区 EFI分区：\nmkfs.fat -F32 /dev/nvme0n1p1 #数据无价请确认后再操作 根分区：\nmkfs.ext4 /dev/nvme0n1p2 #数据无价请确认后再操作 数据分区或家分区：\nmkfs.ext4 /dev/sda1 #数据无价请确认后再操作 挂载分区 mount /dev/nvme0n1p2 /mnt mkdir /mnt/boot mkdir /mnt/home mount /dev/nvme0n1p1 /mnt/boot mount /dev/sda1 /mnt/home 修改镜像站 为了加快下载速度，修改镜像站\n修改文件/etc/pacman.d/mirrorlist\nServer = https://mirrors.bfsu.edu.cn/archlinux/$repo/os/$arch Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch  安装基本系统 pacstrap /mnt base base-devel linux-zen linux-firmware vim networkmanager iwd iptables-nft base和base-devel系统的一些最基本的程序，linux-zen是添加修改了一下功能的linux内核，iwd是intel无线网卡驱动，iptables-nft是使用 nft 接口的iptables\n将磁盘挂载信息写入新系统\ngenfstab -U /mnt  /mnt/etc/fstab  配置系统 切换到新系统 arch-chroot /mnt 本地化设置 设置时区\nln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime hwclock --systohc 设置中文支持，修改/etc/locale.gen\nen_US.UTF-8 UTF-8 zh_CN.UTF-8 UTF-8 zh_TW.UTF-8 UTF-8 zh_HK.UTF-8 UTF-8 使配置生效\nlocale-gen 先将语言设置为英文utf8，先设置成英文，中文在字符界面会乱码\n/etc/locale.conf LANG=en_US.UTF-8 网络配置 配置主机名\n/etc/hostname karch 配置hosts文件\n/etc/hosts # Static table lookup for hostnames. # See hosts(5) for details. 127.0.0.1\tlocalhost ::1\tlocalhost 127.0.1.1\tkarch.localdomain\tkarch 其他设置 设置root密码 passwd 安装intel cpu微码（或amd-ucode） pacman -S intel-ucode 引导设置 配置grub启动\npacman -S grub efibootmgr grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB grub-mkconfig -o /boot/grub/grub.cfg 退出新系统 exit  重启电脑 在重启电脑前先先将挂载的磁盘卸载\numount /mnt/boot umount /mnt/home umount /mnt 重启电脑\nreboot 必要设置 网络配置 启动NetworkManager网络服务\nsystemctl enable NetworkManager 连接网络\n配置dkms和显卡驱动(Nvidia独显+Intel集显)\nsudo pacman -S linux-zen-headers dkms sudo pacman -S nvidia-dkms nvidia-prime sudo pacman -S vulkan-intel intel-media-driver libva-intel-driver 安装kde桌面环境，以及pipewire音频管理，和一些常用的软件\nsudo pacman -S plasma konsole dolphin{,-plugins} pipewire{,-alsa,-pulse,-jack} ark gwenview kdialog spectacle kate 安装中文字体和常用字体并设置默认语言为中文\nsudo pacman -S ttf-sarasa-gothic ttf-fira-{code,mono} /etc/locale.confLANG=en_US.UTF-8 安装libreoffice办公套件\nsudo pacman -S libreoffice-fresh{,-zh-cn} okular latte-dock kfind krename kcalc elisa vlc 配置archlinuxcn源\nsudo pacman -S haveged sudo systemctl start haveged sudo systemctl enable haveged sudo vim /etc/pacman.conf sudo rm -rf /etc/pacman.d/gnupg sudo pacman-key --init sudo pacman-key --populate archlinux sudo pacman -S archlinuxcn-keyring 安装chrome浏览器\npacman -S google-chrome 安装输入法\npacman -S fcitx5-im fcitx5-chinese-addons fcitx5-nord fcitx5-pinyin-zhwiki fcitx5-pinyin-moegirl ~/.pam_environmentGTK_IM_MODULE DEFAULT=fcitx QT_IM_MODULE DEFAULT=fcitx XMODIFIERS DEFAULT=\\@im=fcitx SDL_IM_MODULE DEFAULT=fcitx ",
  "wordCount" : "361",
  "inLanguage": "zh-cn",
  "image":"https://mublog.oss-cn-beijing.aliyuncs.com/824c2c178b82434c2abbe9e485de1daa.jpeg","datePublished": "2021-04-21T12:49:02+08:00",
  "dateModified": "2021-04-21T12:49:02+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://murphywzhu.github.io/blog/posts/arch-install/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "锦酱的博客",
    "logo": {
      "@type": "ImageObject",
      "url": "https://murphywzhu.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://murphywzhu.github.io/blog/" accesskey="h" title="锦酱的博客 (Alt + H)">锦酱的博客</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://murphywzhu.github.io/blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://murphywzhu.github.io/blog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Arch Install
    </h1>
    <div class="post-meta">April 21, 2021
</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://mublog.oss-cn-beijing.aliyuncs.com/824c2c178b82434c2abbe9e485de1daa.jpeg" alt="ArchLinux">
        
</figure>
  <div class="post-content"><h3 id="安装前准备">安装前准备<a hidden class="anchor" aria-hidden="true" href="#安装前准备">#</a></h3>
<h4 id="制作启动盘">制作启动盘<a hidden class="anchor" aria-hidden="true" href="#制作启动盘">#</a></h4>
<p>下载最新版本的<a href="https://mirrors.bfsu.edu.cn/archlinux/iso/latest/"><code>archlinux</code></a>安装镜像文件</p>
<h5 id="linux"><code>Linux</code>：<a hidden class="anchor" aria-hidden="true" href="#linux">#</a></h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dd bs<span style="color:#f92672">=</span>4M <span style="color:#66d9ef">if</span><span style="color:#f92672">=</span>镜像路径 of<span style="color:#f92672">=</span>/dev/USB设备标识符 conv<span style="color:#f92672">=</span>fsync oflag<span style="color:#f92672">=</span>direct status<span style="color:#f92672">=</span>progress
</code></pre></div><h5 id="windows"><code>Windows</code>：<a hidden class="anchor" aria-hidden="true" href="#windows">#</a></h5>
<p>使用<a href="https://rufus.ie/zh/"><code>Rufus</code></a>制作</p>
<h5 id="macos"><code>MacOS</code>：<a hidden class="anchor" aria-hidden="true" href="#macos">#</a></h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">diskutil unmountDisk /dev/USB设备标识符 <span style="color:#75715e">#MacOS也许会自动挂载USB设备，先卸载</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dd <span style="color:#66d9ef">if</span><span style="color:#f92672">=</span>镜像路径 of<span style="color:#f92672">=</span>/dev/USB设备标识符 bs<span style="color:#f92672">=</span>1m
</code></pre></div><h4 id="引导系统">引导系统<a hidden class="anchor" aria-hidden="true" href="#引导系统">#</a></h4>
<p>将制作好的<code>USB</code>启动盘插在要安装<code>archlinux</code>的电脑上</p>
<p>开机的时候按某个按键(不同品牌及机器不一样)，进入选择引导介质的界面，选择<code>USB</code>设备</p>
<p>即可引导进入<code>archlinux live</code></p>
<hr>
<h3 id="安装前配置">安装前配置<a hidden class="anchor" aria-hidden="true" href="#安装前配置">#</a></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">setfont /usr/share/kbd/consolefonts/iso01-12x22.psfu.gz <span style="color:#75715e">#将字体设置大一点</span>
timedatectl set-ntp true <span style="color:#75715e">#设置网络时间</span>
</code></pre></div><h4 id="磁盘设置">磁盘设置<a hidden class="anchor" aria-hidden="true" href="#磁盘设置">#</a></h4>
<blockquote>
<p>数据无价，请确认后再操作</p>
</blockquote>
<h5 id="分区">分区<a hidden class="anchor" aria-hidden="true" href="#分区">#</a></h5>
<p><code>archlinux</code>一般需要分一下几个区</p>
<table>
<thead>
<tr>
<th style="text-align:center">分区名称</th>
<th style="text-align:center">挂载点</th>
<th style="text-align:center">分区类型</th>
<th style="text-align:center">建议大小</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>EFI</code>引导分区</td>
<td style="text-align:center"><code>/mnt/boot</code></td>
<td style="text-align:center"><code>EFI system partition</code></td>
<td style="text-align:center"><code>512M</code></td>
</tr>
<tr>
<td style="text-align:center">根分区</td>
<td style="text-align:center"><code>/mnt</code></td>
<td style="text-align:center"><code>Linux</code></td>
<td style="text-align:center">磁盘剩下的空间</td>
</tr>
<tr>
<td style="text-align:center">数据分区[可选]</td>
<td style="text-align:center"><code>/data</code></td>
<td style="text-align:center"><code>Linux</code></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">家分区[可选]</td>
<td style="text-align:center"><code>/home</code></td>
<td style="text-align:center"><code>Linux</code></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>分区要具体看用途，及你的电脑的磁盘配置</p>
<p>如果只有一块硬盘，可以只分<code>EFI</code>分区及根分区</p>
<p>如果有一块固态和一块机械，可以把固态分为<code>EFI</code>分区及根分区，机械分为数据分区或家分区</p>
<p>我的电脑是一块<code>NVME</code>固态和一块<code>SATA</code>固态，我将<code>NVME</code>分为<code>EFI</code>分区及根分区，将<code>SATA</code>分为家分区</p>
<p>计划好分区后使用<code>fdisk</code>命令来分区</p>
<p>使用<code>fdisk /dev/磁盘标识符</code>进入交互式工具</p>
<p>可以使用<code>lsblk</code>查看到磁盘标识符</p>
<p>如我的电脑有一块名为<code>sda</code>的<code>sata</code>固体硬盘和一块名为<code>nvme0n1</code>的<code>nvme</code>固体硬盘</p>
<pre><code>NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
sda           8:0    0 465.8G  0 disk 
└─sda1        8:1    0 465.8G  0 part /home
nvme0n1     259:0    0 238.5G  0 disk 
├─nvme0n1p1 259:1    0   512M  0 part /boot
└─nvme0n1p2 259:2    0   238G  0 part /
</code></pre><p>我们主要使用<code>fdisk</code>的以下功能</p>
<p>查看分区，在<code>fdisk</code>输入<code>p</code>即可查看已有分区的信息</p>
<p>新建分区表，在<code>fdisk</code>输入<code>g</code>即可创建一个新的<code>gpt</code>分区表</p>
<p>新建分区，在<code>fdisk</code>输入<code>n</code>并根据提示输入大小等信息即可创建一个分区</p>
<p>更改分区类型，<code>fdisk</code>默认的分区格式是<code>linux</code>，创建<code>EFI</code>需要将分区格式改为<code>EFI</code>格式，在<code>fdisk</code>输入<code>t</code>，再根据提示输入<code>EFI</code>的代码<code>1</code>，即可更改为<code>EFI</code>类型，只需要更改<code>EFI</code>分区的格式就行了</p>
<p>保存更改，<code>fdisk</code>交互式命令的操作不会马上生效，需要保存才能生效，输入<code>w</code>即可保存**(数据无价请确认后再操作)**</p>
<h5 id="格式化分区">格式化分区<a hidden class="anchor" aria-hidden="true" href="#格式化分区">#</a></h5>
<p><code>EFI</code>分区：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkfs.fat -F32 /dev/nvme0n1p1 <span style="color:#75715e">#数据无价请确认后再操作</span>
</code></pre></div><p>根分区：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkfs.ext4 /dev/nvme0n1p2 <span style="color:#75715e">#数据无价请确认后再操作</span>
</code></pre></div><p>数据分区或家分区：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkfs.ext4 /dev/sda1 <span style="color:#75715e">#数据无价请确认后再操作</span>
</code></pre></div><h5 id="挂载分区">挂载分区<a hidden class="anchor" aria-hidden="true" href="#挂载分区">#</a></h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mount /dev/nvme0n1p2 /mnt
mkdir /mnt/boot
mkdir /mnt/home
mount /dev/nvme0n1p1 /mnt/boot
mount /dev/sda1 /mnt/home
</code></pre></div><h4 id="修改镜像站">修改镜像站<a hidden class="anchor" aria-hidden="true" href="#修改镜像站">#</a></h4>
<p>为了加快下载速度，修改镜像站</p>
<p>修改文件<code>/etc/pacman.d/mirrorlist</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-apacheconf" data-lang="apacheconf">Server = https://mirrors.bfsu.edu.cn/archlinux/$repo/os/$arch
Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch
</code></pre></div><hr>
<h3 id="安装基本系统">安装基本系统<a hidden class="anchor" aria-hidden="true" href="#安装基本系统">#</a></h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pacstrap /mnt base base-devel linux-zen linux-firmware vim networkmanager iwd iptables-nft
</code></pre></div><p><code>base</code>和<code>base-devel</code>系统的一些最基本的程序，<code>linux-zen</code>是添加修改了一下功能的<code>linux</code>内核，<code>iwd</code>是<code>intel</code>无线网卡驱动，<code>iptables-nft</code>是使用 <code>nft</code> 接口的<code>iptables</code></p>
<p>将磁盘挂载信息写入新系统</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
</code></pre></div><hr>
<h3 id="配置系统">配置系统<a hidden class="anchor" aria-hidden="true" href="#配置系统">#</a></h3>
<h4 id="切换到新系统">切换到新系统<a hidden class="anchor" aria-hidden="true" href="#切换到新系统">#</a></h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">arch-chroot /mnt
</code></pre></div><h4 id="本地化设置">本地化设置<a hidden class="anchor" aria-hidden="true" href="#本地化设置">#</a></h4>
<p>设置时区</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
hwclock --systohc
</code></pre></div><p>设置中文支持，修改<code>/etc/locale.gen</code></p>
<pre><code>en_US.UTF-8 UTF-8
zh_CN.UTF-8 UTF-8
zh_TW.UTF-8 UTF-8
zh_HK.UTF-8 UTF-8
</code></pre><p>使配置生效</p>
<pre><code>locale-gen
</code></pre><p>先将语言设置为英文<code>utf8</code>，先设置成英文，中文在字符界面会乱码</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-apacheconf" data-lang="apacheconf"><span style="color:#960050;background-color:#1e0010">/etc/locale</span>.conf
LANG=en_US.UTF-8
</code></pre></div><h4 id="网络配置">网络配置<a hidden class="anchor" aria-hidden="true" href="#网络配置">#</a></h4>
<p>配置主机名</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-apacheconf" data-lang="apacheconf"><span style="color:#960050;background-color:#1e0010">/etc/</span>hostname
karch
</code></pre></div><p>配置<code>hosts</code>文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-apacheconf" data-lang="apacheconf"><span style="color:#960050;background-color:#1e0010">/etc/</span>hosts
# Static table lookup for hostnames.
<span style="color:#75715e"># See hosts(5) for details.</span>
<span style="color:#960050;background-color:#1e0010">127</span>.<span style="color:#960050;background-color:#1e0010">0</span>.<span style="color:#960050;background-color:#1e0010">0</span>.<span style="color:#960050;background-color:#1e0010">1</span>	localhost
::1		localhost
<span style="color:#960050;background-color:#1e0010">127</span>.<span style="color:#960050;background-color:#1e0010">0</span>.<span style="color:#960050;background-color:#1e0010">1</span>.<span style="color:#960050;background-color:#1e0010">1</span>	<span style="color:#960050;background-color:#1e0010">karch</span>.localdomain	karch
</code></pre></div><h4 id="其他设置">其他设置<a hidden class="anchor" aria-hidden="true" href="#其他设置">#</a></h4>
<h5 id="设置root密码">设置<code>root</code>密码<a hidden class="anchor" aria-hidden="true" href="#设置root密码">#</a></h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">passwd
</code></pre></div><h5 id="安装intel-cpu微码或amd-ucode">安装<code>intel cpu</code>微码（或<code>amd-ucode</code>）<a hidden class="anchor" aria-hidden="true" href="#安装intel-cpu微码或amd-ucode">#</a></h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pacman -S intel-ucode
</code></pre></div><h4 id="引导设置">引导设置<a hidden class="anchor" aria-hidden="true" href="#引导设置">#</a></h4>
<p>配置<code>grub</code>启动</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pacman -S grub efibootmgr
grub-install --target<span style="color:#f92672">=</span>x86_64-efi --efi-directory<span style="color:#f92672">=</span>/boot --bootloader-id<span style="color:#f92672">=</span>GRUB
grub-mkconfig -o /boot/grub/grub.cfg
</code></pre></div><h4 id="退出新系统">退出新系统<a hidden class="anchor" aria-hidden="true" href="#退出新系统">#</a></h4>
<pre><code>exit
</code></pre><hr>
<h3 id="重启电脑">重启电脑<a hidden class="anchor" aria-hidden="true" href="#重启电脑">#</a></h3>
<p>在重启电脑前先先将挂载的磁盘卸载</p>
<pre><code>umount /mnt/boot
umount /mnt/home
umount /mnt
</code></pre><p>重启电脑</p>
<pre><code>reboot
</code></pre><h3 id="必要设置">必要设置<a hidden class="anchor" aria-hidden="true" href="#必要设置">#</a></h3>
<h4 id="网络配置-1">网络配置<a hidden class="anchor" aria-hidden="true" href="#网络配置-1">#</a></h4>
<p>启动<code>NetworkManager</code>网络服务</p>
<pre><code>systemctl enable NetworkManager
</code></pre><p>连接网络</p>
<p>配置<code>dkms</code>和显卡驱动(<code>Nvidia</code>独显+<code>Intel</code>集显)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo pacman -S linux-zen-headers dkms
sudo pacman -S nvidia-dkms nvidia-prime
sudo pacman -S vulkan-intel intel-media-driver libva-intel-driver 
</code></pre></div><p>安装<code>kde</code>桌面环境，以及<code>pipewire</code>音频管理，和一些常用的软件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo pacman -S plasma konsole dolphin<span style="color:#f92672">{</span>,-plugins<span style="color:#f92672">}</span> pipewire<span style="color:#f92672">{</span>,-alsa,-pulse,-jack<span style="color:#f92672">}</span> ark gwenview kdialog spectacle kate 
</code></pre></div><p>安装中文字体和常用字体并设置默认语言为中文</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo pacman -S ttf-sarasa-gothic ttf-fira-<span style="color:#f92672">{</span>code,mono<span style="color:#f92672">}</span>
/etc/locale.confLANG<span style="color:#f92672">=</span>en_US.UTF-8
</code></pre></div><p>安装<code>libreoffice</code>办公套件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo pacman -S libreoffice-fresh<span style="color:#f92672">{</span>,-zh-cn<span style="color:#f92672">}</span> okular latte-dock kfind krename kcalc elisa vlc
</code></pre></div><p>配置<code>archlinuxcn</code>源</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo pacman -S haveged
sudo systemctl start haveged
sudo systemctl enable haveged
sudo vim /etc/pacman.conf
sudo rm -rf /etc/pacman.d/gnupg
sudo pacman-key --init
sudo pacman-key --populate archlinux
sudo pacman -S archlinuxcn-keyring
</code></pre></div><p>安装<code>chrome</code>浏览器</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pacman -S google-chrome
</code></pre></div><p>安装输入法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-nord fcitx5-pinyin-zhwiki fcitx5-pinyin-moegirl
~/.pam_environmentGTK_IM_MODULE DEFAULT<span style="color:#f92672">=</span>fcitx
QT_IM_MODULE  DEFAULT<span style="color:#f92672">=</span>fcitx
XMODIFIERS    DEFAULT<span style="color:#f92672">=</span><span style="color:#ae81ff">\@</span>im<span style="color:#f92672">=</span>fcitx
SDL_IM_MODULE DEFAULT<span style="color:#f92672">=</span>fcitx
</code></pre></div>
</div>
  <footer class="post-footer">
  </footer>
</article>
    </main>
    <footer class="footer">
    <span>&copy; 2021 <a href="https://murphywzhu.github.io/blog/">锦酱的博客</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
